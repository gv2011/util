package com.github.gv2011.util.bc;

import static com.github.gv2011.util.Verify.notNull;
import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.is;

import java.math.BigInteger;

import org.junit.jupiter.api.Test;

import com.github.gv2011.util.StreamUtils;
import com.github.gv2011.util.sec.OpenSshRsaPublicKey;

class BcSecProviderTest {

  //SHA256:XuI5oPQKZJsutf3edlhjKkyVeFw7/ccTWwEE0gBa+es rsa-testkey-4096

  @Test
  void test() {
    final OpenSshRsaPublicKey key = new BcSecProvider().parseOpenSshRsaPublicKey(
      StreamUtils.readText(()->notNull(getClass().getResourceAsStream("id_rsa.pub")))
    );
    assertThat(
      key.modulus(),
      is(new BigInteger(
          "70158376346746020839987843277230688846910302234337714400325489763040809161922675"
        + "22480554949062500047227012063947577502963316978083056189393247754308445812281692"
        + "91077217430114862632104852434778081072872916018594178006369316183902699388036397"
        + "14278558319166086894450498290466379218348514742516599491887623554066216701996752"
        + "46292389807160840048227716019479998171935070763797331488996212645360256664664073"
        + "18293643076777224942998851749913849182566730591590344605075861202430262706720581"
        + "42100359797309049010335190691112323894750290721628931398888412294222655263605217"
        + "09282350871431678587569112667957806666252166584186009203319570100713208980098067"
        + "73067825206811126865994285950025787743158177978695545148744377382855469921955675"
        + "70652539195243672730436647156153514869332255527658918586519272290635956071808167"
        + "45514386676788947191805872188641864241595508071681699952196033072739448368700959"
        + "01029050870068845094404608072454011578939963307885618634070738842384988011242655"
        + "94934396996310055300581936053476962669493149008860686772003629757374965542287949"
        + "36840441704211274463963154749429730355050865460992479844997767069066276671527130"
        + "39247181561223089418166382665569342336177812408617405423962961917681176938625055"
        + "304575620174846658785672804877491"
      ))
    );
    assertThat(key.publicExponent(), is(BigInteger.valueOf(65537L)));
    assertThat(key.comment(), is("rsa-testkey-4096"));
  }

}
